<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Tutoriel</title>
<style>
canvas{
	border:2px black solid;
	background-color:green;
	margin:auto;
	display:block;
}

</style>
</head>

<body>
<canvas id="monCanvas"></canvas>

<script>

var canvas=document.getElementById("monCanvas")
var ctx=canvas.getContext("2d")
canvas.width=600
canvas.height=700

var character=new Image()
character.src="mario.png"

var slow=new Image()
slow.src="flower.png"

var mega=new Image()
mega.src="megaMush.png"

var speed=new Image()
speed.src="mush.png"

var end=new Image()
end.src="egg.png"

var finish=new Image()
finish.src="exit.png"

var upSound=new Audio()
upSound.src="up.wav"

var downSound=new Audio()
downSound.src="down.wav"

var music=new Audio()
music.src="theme.mp3"

var spawn={
    x:0,
    y:0,
    w:150,
    h:150,
    color:"pink"
}

var checkPoint1={
    x:0,
    y:600,
    w:165,
    h:100,
    color:"pink",
}

var checkPoint2={
    x:415,
    y:0,
    w:185,
    h:120,
    color:"pink",
}

var player={
    x:50,
    y:80,
    w:50,
    h:50,
    speed:4,
}

var giga={
    x:305,
    y:335,
    w:40,
    h:40,
}

var giga2={
    x:535,
    y:285,
    w:40,
    h:40,
}

var egg={
    x:200,
    y:125,
    w:40,
    h:40,
}

var mushroom={
    x:340,
    y:490,
    w:40,
    h:40,
}

var shroom2={
    x:440,
    y:490,
    w:40,
    h:40,
}

var star={
    x:180,
    y:25,
    w:40,
    h:40,
}

var wall={
    x:150,
    y:0,
    w:15,
    h:600,
    color:"black",
}

var wall1={
    x:55,
    y:580,
    w:95,
    h:20,
    color:"black",
}

var wall2={
    x:415,
    y:120,
    w:15,
    h:580,
    color:"black",
}

var death1={
    x:75,
    y:275,
    w:75,
    h:20,
    color:"red",
}

var death2={
    x:0,
    y:400,
    w:80,
    h:20,
    color:"red",
}

var death3={
    x:55,
    y:560,
    w:95,
    h:20,
    color:"red",
}

var death4={
    x:165,
    y:0,
    w:10,
    h:600,
    color:"red",
}

var death5={
    x:400,
    y:120,
    w:15,
    h:580,
    color:"red",
}

var death6={
    x:280,
    y:550,
    w:130,
    h:20,
    color:"red",
}

var death7={
    x:280,
    y:450,
    w:130,
    h:20,
    color:"red",
}

var death8={
    x:330,
    y:250,
    w:70,
    h:20,
    color:"red",
}

var death9={
    x:175,
    y:100,
    w:80,
    h:20,
    color:"red",
}

var death10={
    x:415,
    y:250,
    w:16,
    h:100,
    color:"red",
}

var death11={
    x:585,
    y:250,
    w:16,
    h:100,
    color:"red",
}

var death12={
    x:415,
    y:460,
    w:16,
    h:100,
    color:"red",
}

var death13={
    x:588,
    y:460,
    w:12,
    h:100,
    color:"red",
}

var death14={
    x:494,
    y:290,
    w:30,
    h:20,
    color:"red",
}

var death15={
    x:497,
    y:440,
    w:30,
    h:30,
    color:"red",
}

var death16={
    x:431,
    y:540,
    w:30,
    h:20,
    color:"red",
}

var death17={
    x:558,
    y:540,
    w:30,
    h:20,
    color:"red",
}

var exit={
    x:-200,
    y:580,
    w:100,
    h:100,
}

var keyDown={}

function drawSquare(){

    ctx.fillStyle=spawn.color
    ctx.fillRect(spawn.x, spawn.y, spawn.w, spawn.h,)

    ctx.fillStyle=checkPoint1.color
    ctx.fillRect(checkPoint1.x, checkPoint1.y, checkPoint1.w, checkPoint1.h,)

    ctx.fillStyle=checkPoint2.color
    ctx.fillRect(checkPoint2.x, checkPoint2.y, checkPoint2.w, checkPoint2.h,)

    ctx.drawImage(character, player.x, player.y, player.w, player.h,)

    ctx.drawImage(mega, giga.x, giga.y, giga.w, giga.h,)

    ctx.drawImage(mega, giga.x, giga.y, giga.w, giga.h,)

    ctx.drawImage(mega, giga2.x, giga2.y, giga2.w, giga2.h,)

    ctx.drawImage(speed, mushroom.x, mushroom.y, mushroom.w, mushroom.h,)

    ctx.drawImage(speed, shroom2.x, shroom2.y, shroom2.w, shroom2.h,)

    ctx.drawImage(end, egg.x, egg.y, egg.w, egg.h,)

    ctx.drawImage(slow, star.x, star.y, star.w, star.h,)

    ctx.drawImage(finish, exit.x, exit.y, exit.w, exit.h,)

    ctx.fillStyle=wall.color
    ctx.fillRect(wall.x, wall.y, wall.w, wall.h,)

    ctx.fillStyle=wall1.color
    ctx.fillRect(wall1.x, wall1.y, wall1.w, wall1.h,)

    ctx.fillStyle=wall2.color
    ctx.fillRect(wall2.x, wall2.y, wall2.w, wall2.h,)

    ctx.fillStyle=death1.color
    ctx.fillRect(death1.x, death1.y, death1.w, death1.h,)

    ctx.fillStyle=death2.color
    ctx.fillRect(death2.x, death2.y, death2.w, death2.h,)

    ctx.fillStyle=death3.color
    ctx.fillRect(death3.x, death3.y, death3.w, death3.h,)

    ctx.fillStyle=death4.color
    ctx.fillRect(death4.x, death4.y, death4.w, death4.h,)

    ctx.fillStyle=death5.color
    ctx.fillRect(death5.x, death5.y, death5.w, death5.h,)

    ctx.fillStyle=death6.color
    ctx.fillRect(death6.x, death6.y, death6.w, death6.h,)

    ctx.fillStyle=death7.color
    ctx.fillRect(death7.x, death7.y, death7.w, death7.h,)

    ctx.fillStyle=death8.color
    ctx.fillRect(death8.x, death8.y, death8.w, death8.h,)

    ctx.fillStyle=death9.color
    ctx.fillRect(death9.x, death9.y, death9.w, death9.h,)

    ctx.fillStyle=death10.color
    ctx.fillRect(death10.x, death10.y, death10.w, death10.h,)

    ctx.fillStyle=death11.color
    ctx.fillRect(death11.x, death11.y, death11.w, death11.h,)

    ctx.fillStyle=death12.color
    ctx.fillRect(death12.x, death12.y, death12.w, death12.h,)

    ctx.fillStyle=death13.color
    ctx.fillRect(death13.x, death13.y, death13.w, death13.h,)

    ctx.fillStyle=death14.color
    ctx.fillRect(death14.x, death14.y, death14.w, death14.h,)

    ctx.fillStyle=death15.color
    ctx.fillRect(death15.x, death15.y, death15.w, death15.h,)

    ctx.fillStyle=death16.color
    ctx.fillRect(death16.x, death16.y, death16.w, death16.h,)

    ctx.fillStyle=death17.color
    ctx.fillRect(death17.x, death17.y, death17.w, death17.h,)
}

document.addEventListener("keydown", function(e){
    keyDown[e.keyCode]=true
    console.log(keyDown)
})

document.addEventListener("keyup", function(e){
    delete keyDown[e.keyCode]
    console.log(keyDown)
})

function clavier(){
    if (65 in keyDown && player.x>0){
        player.x-=player.speed
    }

    if (68 in keyDown && player.x<canvas.width-player.w){
        player.x+=player.speed
    }

    if (87 in keyDown && player.y>0){
        player.y-=player.speed
    }

    if (83 in keyDown && player.y<canvas.height-player.h){
        player.y+=player.speed
    }

    mur(player,wall)
    mur1(player,wall1)
    mur2(player,wall2)
}

function collision(a,b){
    if(a.x<b.x+b.w && a.y+a.h>b.y && a.y<b.y+b.h && a.x+a.w>b.x){
        return(true)
    }
}

function mur(player,wall){
    if(collision(player,wall)){
        if(65 in keyDown || 68 in keyDown){
            if(player.x<wall.x+wall.w/2){
                player.x-=player.speed
            }else{
                player.x+=player.speed
            }
        }

        if(83 in keyDown || 87 in keyDown){
            if(player.y<wall.y+wall.h/2){
                player.y-=player.speed
            }else{
                player.y+=player.speed
            }
        }
    }
}

function mur1(player,wall1){
    if(collision(player,wall1)){
        if(65 in keyDown || 68 in keyDown){
            if(player.x<wall1.x+wall1.w/2){
                player.x-=player.speed
            }else{
                player.x+=player.speed
            }
        }

        if(83 in keyDown || 87 in keyDown){
            if(player.y<wall1.y+wall1.h/2){
                player.y-=player.speed
            }else{
                player.y+=player.speed
            }
        }
    }
}

function mur2(player,wall2){
    if(collision(player,wall2)){
        if(65 in keyDown || 68 in keyDown){
            if(player.x<wall2.x+wall2.w/2){
                player.x-=player.speed
            }else{
                player.x+=player.speed
            }
        }

        if(83 in keyDown || 87 in keyDown){
            if(player.y<wall2.y+wall2.h/2){
                player.y-=player.speed
            }else{
                player.y+=player.speed
            }
        }
    }
}

function powerup(){
    if(collision(player,giga)){
        giga.x=-200
        player.w=75
        player.h=75
        downSound.play()
    }

    if(collision(player,giga2)){
        giga2.x=-200
        player.w=75
        player.h=75
        downSound.play()
    }

    if(collision(player,mushroom)){
        mushroom.x=-200
        player.speed=8
        downSound.play()
    }

    if(collision(player,shroom2)){
        shroom2.x=-200
        player.speed=8
        downSound.play()
    }

    if(collision(player,star)){
        star.x=-200
        player.speed=2
        upSound.play()
    }
    
    if(collision(player,egg)){
        egg.x=-200
        exit.x=465
        upSound.play()
    }

    if(collision(player,exit)){
        window.location.href="menu.html"
    }

} 

function checkDeath(){
    if(collision(player,death1)){
        player.x=50
        player.y=80
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death2)){
        player.x=50
        player.y=80
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death3)){
        player.x=50
        player.y=80
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death4)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death5)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death6)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death7)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death8)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death9)){
        player.x=50
        player.y=650
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death10)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death11)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death12)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death13)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death14)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death15)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death16)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }

    if(collision(player,death17)){
        player.x=480
        player.y=45
        player.speed=4
        player.w=50
        player.h=50
        mushroom.x=340
        giga.x=305
        star.x=180
        egg.x=200
        exit.x=-200
        giga2.x=535
        shroom2.x=440
    }
}

function instruction(){
    ctx.font="12px Verdana"
    ctx.fillStyle='black'
    ctx.fillText("Bienvenue dans ce jeu", 10, 20)
    ctx.fillText("2D! Pour vous déplacer,", 5, 35)
    ctx.fillText("utilisez les touches", 15, 50)
    ctx.fillText("W-A-S-D.", 45, 65)

    ctx.fillText("Vous pourrez toucher", 11, 178)
    ctx.fillText("aux murs noirs, mais à ", 6, 193)
    ctx.fillText("la moindre contact d'un", 4, 208)
    ctx.fillText("mur rouge, la mort ", 16, 223)
    ctx.fillText("vous trouvera!", 29, 238)

    ctx.fillText("Lorsque vous mourrez,", 12, 615)
    ctx.fillText("vous réapparaîtriez au", 9, 630)
    ctx.fillText("dernier checkpoint", 20, 645)
    ctx.fillText("(carrés roses.)", 30, 660)

    ctx.fillText("Testez les 4 items de ce jeu", 200,650)
    ctx.fillText("ci-dessus!", 255,665)

    ctx.fillText("Champi: votre vitesse double.", 205,545)

    ctx.fillText("Méga champi:", 282,405)
    ctx.fillText("votre grosseur est", 265,420)
    ctx.fillText("multiplié par 1.5.", 270,435)

    ctx.fillText("Oeuf de Yoshi:", 180,185)
    ctx.fillText("vous débloque", 180,200)
    ctx.fillText("la sortie", 195,215)
    ctx.fillText("(le château).", 185,230)

    ctx.fillText("Fleur de glace: votre vitesse", 230,45)
    ctx.fillText("diminue de moitié.", 260,60)

    ctx.fillText("Attention! Lorsque vous", 430,30)
    ctx.fillText("mourrez, tous les effets des", 420,45)
    ctx.fillText("items sont supprimés,", 435,60)
    ctx.fillText("mais ils vont réapparaître.", 425,75)

    ctx.fillText("Dernière chose: faites", 445,390)
    ctx.fillText("gaffe aux pièges!", 460,405)
}

function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height)
	requestAnimationFrame(gameLoop)
    powerup()
    clavier()
    drawSquare()
    checkDeath()
    instruction()
    music.play()
}

gameLoop()

</script>
</body>
</html>